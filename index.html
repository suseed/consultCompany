<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ê¸°ì—…ê³ ê° ìƒë‹´ DB</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    body{font-family:Arial,Helvetica,sans-serif;margin:20px;background:#f7f9fc}
    h1{margin-bottom:10px}
    table{width:100%;border-collapse:collapse;background:#fff}
    th,td{border:1px solid #ccc;padding:6px 8px;text-align:left;font-size:14px}
    th{background:#e9edf5}
    tr:nth-child(even){background:#f5f7fb}
    .controls{margin:10px 0}
    .controls button{margin-right:6px;padding:6px 12px;border:none;border-radius:4px;background:#2d6cdf;color:#fff;cursor:pointer;font-size:14px}
    .controls button:hover{opacity:.9}
    .del-btn{background:none;border:none;color:#e00;font-size:16px;cursor:pointer}
    @media print{
        .controls,form{display:none}
        body{margin:0}
    }
</style>
</head>
<body>
<h1>ê¸°ì—…ê³ ê° ìƒë‹´ DB</h1>

<form id="entryForm" autocomplete="off">
    <table>
        <tr>
            <td><input placeholder="ê¸°ì—…ëª…"          id="ê¸°ì—…ëª…"></td>
            <td><input placeholder="ì—…ì¢…"            id="ì—…ì¢…"></td>
            <td><input placeholder="ë§ˆì¼€í„°"          id="ë§ˆì¼€í„°"></td>
            <td><input placeholder="ë‹´ë‹¹ì"          id="ë‹´ë‹¹ì"></td>
            <td><input placeholder="ê´€ì‹¬ê³¼ëª©"        id="ê´€ì‹¬ê³¼ëª©"></td>
            <td><input placeholder="ì‹ ì²­ê³¼ëª©"        id="ì‹ ì²­ê³¼ëª©"></td>
            <td><input placeholder="ìƒë‹´ë‚´ìš©"        id="ìƒë‹´ë‚´ìš©"></td>
            <td><input type="datetime-local"         id="ìƒë‹´ì¼ì‹œ"></td>
            <td><input type="datetime-local"         id="ê°œì„¤í¬ë§ì¼ì‹œ"></td>
            <td><button type="button" onclick="addRow()">ì¶”ê°€</button></td>
        </tr>
    </table>
</form>

<div class="controls">
    <button onclick="saveJSON()">JSON ì €ì¥</button>
    <button onclick="document.getElementById('jsonInput').click()">JSON ë¶ˆëŸ¬ì˜¤ê¸°</button>
    <button onclick="exportCSV()">CSV ì €ì¥</button>
    <button onclick="window.print()">ì¸ì‡„Â·PDF</button>
    <input type="file" id="jsonInput" accept=".json" style="display:none" onchange="loadJSON(event)">
</div>

<table id="dataTable">
    <thead>
        <tr>
            <th>ê¸°ì—…ëª…</th><th>ì—…ì¢…</th><th>ë§ˆì¼€í„°</th><th>ë‹´ë‹¹ì</th>
            <th>ê´€ì‹¬ê³¼ëª©</th><th>ì‹ ì²­ê³¼ëª©</th><th>ìƒë‹´ë‚´ìš©</th>
            <th>ìƒë‹´ì¼ì‹œ</th><th>ê°œì„¤ í¬ë§ì¼ì‹œ</th><th>ì•¡ì…˜</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<script>
let data = JSON.parse(localStorage.getItem('corpCounselDB')||'[]');
refreshTable();

function addRow(){
    const f = id=>document.getElementById(id).value.trim();
    const row = {
        ê¸°ì—…ëª…:f('ê¸°ì—…ëª…'), ì—…ì¢…:f('ì—…ì¢…'), ë§ˆì¼€í„°:f('ë§ˆì¼€í„°'), ë‹´ë‹¹ì:f('ë‹´ë‹¹ì'),
        ê´€ì‹¬ê³¼ëª©:f('ê´€ì‹¬ê³¼ëª©'), ì‹ ì²­ê³¼ëª©:f('ì‹ ì²­ê³¼ëª©'), ìƒë‹´ë‚´ìš©:f('ìƒë‹´ë‚´ìš©'),
        ìƒë‹´ì¼ì‹œ:f('ìƒë‹´ì¼ì‹œ'), ê°œì„¤í¬ë§ì¼ì‹œ:f('ê°œì„¤í¬ë§ì¼ì‹œ')
    };
    if(!row.ê¸°ì—…ëª…) { alert('ê¸°ì—…ëª…ì€ í•„ìˆ˜ì…ë‹ˆë‹¤!'); return; }
    data.push(row);
    saveLocal(); refreshTable(); document.getElementById('entryForm').reset();
}

function refreshTable(){
    const tb=document.querySelector('#dataTable tbody');
    tb.innerHTML='';
    data.forEach((r,i)=>{
        const tr=tb.insertRow();
        ["ê¸°ì—…ëª…","ì—…ì¢…","ë§ˆì¼€í„°","ë‹´ë‹¹ì","ê´€ì‹¬ê³¼ëª©","ì‹ ì²­ê³¼ëª©","ìƒë‹´ë‚´ìš©","ìƒë‹´ì¼ì‹œ","ê°œì„¤í¬ë§ì¼ì‹œ"].forEach(k=>{
            tr.insertCell().textContent=r[k]||'';
        });
        const action=tr.insertCell();
        action.innerHTML='<button class="del-btn" title="ì‚­ì œ" onclick="delRow('+i+')">ğŸ—‘ï¸</button>';
    });
}

function delRow(idx){
    if(confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')){
        data.splice(idx,1);
        saveLocal(); refreshTable();
    }
}

function saveLocal(){
    localStorage.setItem('corpCounselDB',JSON.stringify(data));
}

function saveJSON(){
    const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
    downloadBlob(blob,'corpCounselDB_'+dateStamp()+'.json');
}

function loadJSON(e){
    const file=e.target.files[0];
    if(!file) return;
    const reader=new FileReader();
    reader.onload=evt=>{
        try{
            data=JSON.parse(evt.target.result);
            saveLocal(); refreshTable();
        }catch(err){
            alert('JSON í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤');
        }
    };
    reader.readAsText(file);
}

function exportCSV(){
    const cols=["ê¸°ì—…ëª…","ì—…ì¢…","ë§ˆì¼€í„°","ë‹´ë‹¹ì","ê´€ì‹¬ê³¼ëª©","ì‹ ì²­ê³¼ëª©","ìƒë‹´ë‚´ìš©","ìƒë‹´ì¼ì‹œ","ê°œì„¤í¬ë§ì¼ì‹œ"];
    const lines=[cols.join(',')];
    data.forEach(r=>{
        lines.push(cols.map(k=>'"'+(r[k]||'').replace(/"/g,'""')+'"').join(','));
    });
    const blob=new Blob([lines.join('\n')],{type:'text/csv'});
    downloadBlob(blob,'corpCounselDB_'+dateStamp()+'.csv');
}

function downloadBlob(blob,filename){
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a');
    a.href=url;
    a.download=filename;
    a.click();
    URL.revokeObjectURL(url);
}

function dateStamp(){
    const d=new Date();
    return d.toISOString().slice(0,10).replace(/-/g,'');
}
</script>
</body>
</html>
